<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Sveris Tales: Tetris in clojurescript and re-frame Part 2 - Basic Layout</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href='http://fonts.googleapis.com/css?family=Alegreya:400italic,700italic,400,700' rel='stylesheet'
          type='text/css'>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/styles/default.min.css">
    <link href="../css/screen.css" rel="stylesheet" type="text/css" />
</head>
<body>


<nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/index.html">Sveris Tales</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li ><a href="/index.html">Home</a></li>
                <li
                ><a href="/archives.html">Archives</a></li>
                
                <li
                >
                <a href="/pages/about.html">About</a>
                </li>
                
                <li><a href="/feed.xml">RSS</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div><!--/.container-fluid -->
</nav>


<div class="container">


    <div class="row">
        <div class="col-lg-9">
            <div id="content">
                
<div id="post">
    <div id="post-header">
    <div id="post-meta" class="row">
        <div class="col-lg-6">May 31, 2015</div>
        
    </div>
    <h2>Tetris in clojurescript and re-frame Part 2 - Basic Layout</h2>
</div>
<div>
    
    <h2><a name="html"></a>HTML</h2><p>First he starts with the HTML part for the application. This is the code:</p><pre><code>{% extends &quot;base.html&quot; %}
{% block content %}

&lt;div id=&quot;tetris-main&quot;&gt;&lt;/div&gt;
{% endblock %}

{% block js-bottom %}
&lt;script type=&quot;text/javascript&quot;&gt;de.sveri.omtet.tetris.core.main&#40;&#41;;&lt;/script&gt;
{% endblock %}    
</code></pre>I am using selmer as a templating engine, so all you see here is the main div where the clojurescript will attach toand the call of the clojurescript tetris main function.<br />You can find the code here: <a href='https://github.com/sveri/omtet/blob/single&#95;player&#95;0.1/resources/templates/tetris/index.html'>index.html</a><h2><a name="canvas"></a>Canvas</h2><p>This is where we are already starting to use clojurescript and this differs from the original tutorial. Instead of defining the canvas in plain html we will use reagent for this.</p><pre><code>&#40;defn &#94;:export main &#91;&#93;
  &#40;rf/dispatch &#91;:initialise-db&#93;&#41;
  &#40;reagent/render-component &#40;fn &#91;&#93; &#91;core&#93;&#41; &#40;h/get-elem &quot;tetris-main&quot;&#41;&#41;&#41;   
</code></pre>This is the main function that is called from the html file. It will render a <strong>core</strong> function on the <strong>tetris-main</strong> html div. The ^export directive says that the main functions name should not be minimized so that it can be called from the html file.<br /><p>This is the core function: </p><pre><code>&#40;defn core &#91;&#93;
  &#40;let &#91;tet-width &quot;200px&quot;&#93;
    &#91;:div.row
     &#91;:div.col-md-3
      &#91;:canvas#tetris-canv {:height &quot;400px&quot; :width tet-width :style {:background-color &quot;#444444&quot;}}&#93;
      &#91;:div#score {:style {:background-color &quot;#CCCCCC&quot; :width tet-width}} &quot;Score: &quot;&#93;&#93;
     &#91;:div.col-md-3
      &#91;:div
       &#91;:button.btn.btn-primary
        {:on-click #&#40;rf/dispatch &#91;:start-game&#93;&#41;} &quot;Start&quot;&#93;
       &#91;:br&#93;
       &#91;:button.btn.btn-primary {:on-click #&#40;rf/dispatch &#91;:restart-game&#93;&#41;} &quot;Restart&quot;&#93;&#93;&#93;&#93;&#41;&#41;
</code></pre>This just defines the HTML structure of the canvas and two buttons. One to start the game and one to restart the game.There is also a Score panel beneath the canvas.<br /><p>One thing to note here are the <strong>#(rf/dispatch...</strong> functions. <em>rf</em> is the re-frame namespace and <em>dispatch</em> will be called when a click on the respective button was done.</p><p>Every <strong>dispatch</strong> function takes 1..n arguments whereas the first one is always a vector containing the event id path. In these cases: <em>:start-game</em> and <em>:restart-game</em>, which do what their name implies.</p><p>We will not init the canvas itself yet. This will be done as part of the application state initalization.</p><h2><a name="sourcecode"></a>Sourcecode</h2><p><a href='https://github.com/sveri/omtet/blob/Part2/src/cljs/de/sveri/omtet/tetris/core.cljs'>Part 2 - core.cljs</a></p>
</div>

<div id="post-tags">
    <b>Tags: </b>
    
    <a href="/tags/html5.html">html5</a>
    
    <a href="/tags/re-frame.html">re-frame</a>
    
    <a href="/tags/tetris.html">tetris</a>
    
    <a href="/tags/part 2.html">part 2</a>
    
    <a href="/tags/clojuresrcipt.html">clojuresrcipt</a>
    
</div>


    <div id="prev-next">
        
        <a href="/posts/2015-05-31-tetris-3.html">&laquo; Tetris in clojurescript and re-frame Part 3</a>
        
        
        <a class="right" href="/posts/2015-05-31-tetris-1.html">Tetris in clojurescript and re-frame Part 1 &raquo;</a>
        
    </div>

    


</div>

            </div>
        </div>

        <div class="col-md-3">
            <div id="sidebar">
                <h3>Links</h3>
                <ul id="links">
                    <li><a href="http://cryogenweb.org/docs/home.html">Cryogen Docs</a></li>
                    <li><a href="http://carmenla.me/blog/index.html">Carmen's Blog</a></li>
                    
                </ul>
                
                <div id="recent">
                    <h3>Recent Posts</h3>
                    <ul>
                        
                        <li><a href="/posts/2015-05-31-tetris-5.html">Tetris in clojurescript and re-frame Part 5</a></li>
                        
                        <li><a href="/posts/2015-05-31-tetris-4.html">Tetris in clojurescript and re-frame Part 4</a></li>
                        
                        <li><a href="/posts/2015-05-31-tetris-3.html">Tetris in clojurescript and re-frame Part 3</a></li>
                        
                    </ul>
                </div>
                
                
                <div id="tags">
                    <h3>Tags</h3>
                    <ul>
                        
                        <li><a href="/tags/html5.html">html5</a></li>
                        
                        <li><a href="/tags/part 5.html">part 5</a></li>
                        
                        <li><a href="/tags/new blog.html">new blog</a></li>
                        
                        <li><a href="/tags/cryogen.html">cryogen</a></li>
                        
                        <li><a href="/tags/re-frame.html">re-frame</a></li>
                        
                        <li><a href="/tags/part 1.html">part 1</a></li>
                        
                        <li><a href="/tags/tetris.html">tetris</a></li>
                        
                        <li><a href="/tags/part 3.html">part 3</a></li>
                        
                        <li><a href="/tags/part 2.html">part 2</a></li>
                        
                        <li><a href="/tags/clojuresrcipt.html">clojuresrcipt</a></li>
                        
                        <li><a href="/tags/part 4.html">part 4</a></li>
                        
                    </ul>
                </div>
                
            </div>
        </div>
    </div>
    <footer>Copyright &copy; 2015 Sven Richter
        <p style="text-align: center;">Powered by <a href="http://cryogenweb.org">Cryogen</a></p></footer>
</div>
<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="../js/highlight.pack.js" type="text/javascript"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

